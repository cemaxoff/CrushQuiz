<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Crush Quiz</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>

  body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background: linear-gradient(135deg, #dbeafe, #eef2ff, #f8fafc);
  min-height: 100vh;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 10px; /* pour que ce soit pas coll√© aux bords */
  box-sizing: border-box;
}

.box {
  width: 100%;
  max-width: 420px; /* reste la m√™me sur grand √©cran */
  background: rgba(255, 255, 255, 0.95);
  padding: 24px 16px; /* r√©duit l√©g√®rement pour mobile */
  border-radius: 18px;
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(6px);
  box-sizing: border-box;
}

  button {
    font-family: "Inter", sans-serif;
    width: 100%;
    padding: 14px; /* un peu plus confortable pour le tactile */
    margin-bottom: 12px;
    font-size: 16px; /* l√©g√®rement plus grand pour lisibilit√© sur mobile */
    font-weight: 500;
    border: none;
    border-radius: 12px;
    background: linear-gradient(135deg, #e5e7eb, #f9fafb);
    color: #1f2937;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
    transition: all 0.2s ease;
  }

 button:hover {
  transform: translateY(-1px);
  background: linear-gradient(135deg, #d1d5db, #f3f4f6);
 }

  #backArrow {
    position: absolute;
    top: 12px;
    left: 12px;
    font-size: 24px;
    cursor: pointer;
    z-index: 10;
  }


  h2 {
    font-size: 22px;
    color: #111827;
    margin-bottom: 8px;
  }

  #progress {
    font-size: 14px;
    color: #6b7280;
    margin-bottom: 24px;
  }

  button:hover {
    transform: translateY(-2px);
    background: linear-gradient(135deg, #d1d5db, #f3f4f6);
  }

  button:active {
    transform: translateY(0);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  .result-love {
    color: #065f46;
  }

  .result-friend {
    color: #1e40af;
  }

  .result-nothing {
    color: #991b1b;
  }

  .advice {
    margin-top: 14px;
    font-size: 15px;
    color: #374151;
    line-height: 1.6;
  }

  .progress-bar {
  width: 100%;
  height: 6px;
  background: #e5e7eb;
  border-radius: 999px;
  overflow: hidden;
  margin-bottom: 20px;
}

.progress-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #2563eb, #4f46e5);
  transition: width 0.4s ease;
}

.fade {
  animation: fadeSlide 0.35s ease;
}

@keyframes fadeSlide {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.percent-container {
  margin-bottom: 20px;
}

.percent-label {
  font-size: 14px;
  font-weight: 500;
  color: #1f2937;
  margin-bottom: 6px;
}

.percent-bar {
  width: 100%;
  height: 10px;
  background: #e5e7eb;
  border-radius: 999px;
  overflow: hidden;
}

.percent-fill {
  height: 100%;
  background: linear-gradient(90deg, #22c55e, #16a34a);
  border-radius: 999px;
  transition: width 0.6s ease;
}

</style>

</head>
<body>

<div class="box" id="app">

  <!-- √âCRAN ACCUEIL -->
  <div id="startScreen">
    <h2>D√©couvre si ton/ta crush t‚Äôaime</h2>
    <p>R√©ponds honn√™tement pour obtenir un r√©sultat fiable.</p>
    <button onclick="goToGender()">Commencer le CrushQuiz</button>
  </div>

  <!-- √âCRAN GENRE -->
  <div id="genderSelect" style="display:none;">
    <h2>Qui est ton/ta crush ?</h2>
    <button onclick="setGender('elle')">Elle</button>
    <button onclick="setGender('il')">Il</button>
    <button onclick="setGender('iel')">Iel</button>
  </div>


  <!-- QUIZ -->
  <div id="quiz" style="display:none;">
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <div id="backArrow" style="display:none; cursor:pointer;">‚¨ÖÔ∏è</div>

    <h2 id="question"></h2>
    <p id="progress"></p>
    <div id="answers"></div>
    <div id="navButtons"></div>

  </div>

</div>

<script>
  let history = [];
  let gender = "elle"; // "elle", "il", "iel"

  const navButtonsEl = document.getElementById("navButtons");


function startQuiz() {
  document.getElementById("startScreen").style.display = "none";
  document.getElementById("genderSelect").style.display = "block";
}

function goToGender() {
  document.getElementById("startScreen").style.display = "none";
  document.getElementById("genderSelect").style.display = "block";
}

function shareResult() {
  const text = document.querySelector(".result-love, .result-friend, .result-nothing")?.innerText || "Mon r√©sultat au CrushQuiz";

  const message = `J‚Äôai fait le CrushQuiz üò≥
R√©sultat : ${text}

üëâ Fais le test toi aussi :
${window.location.href}`;

  if (navigator.share) {
    navigator.share({
      title: "CrushQuiz",
      text: message,
      url: window.location.href
    });
  } else {
    navigator.clipboard.writeText(message);
    alert("Lien copi√© üìã Tu peux le partager !");
  }
}

  const progressFill = document.getElementById("progressFill");

const questions = [
  {
    question: "Est-ce qu'{{subj}} entame la conversation sans raison pr√©cise ?",
    answers: [
      { text: "Oui, souvent", score: { love: 2 } },
      { text: "Parfois", score: { friend: 1 } },
      { text: "Presque jamais", score: { nothing: 2 } }
    ]
  },
  {
    question: "Quand vous discutez, est-ce qu'{{subj}} relance la conversation ?",
    answers: [
      { text: "Oui, clairement", score: { love: 2 } },
      { text: "De temps en temps", score: { friend: 1 } },
      { text: "Non", score: { nothing: 2 } }
    ]
  },
  {
    question: "Est-ce qu'{{subj}} se souvient de d√©tails que tu lui as d√©j√† dits ?",
    answers: [
      { text: "Oui, souvent", score: { love: 2 } },
      { text: "Parfois", score: { friend: 1 } },
      { text: "Rarement", score: { nothing: 2 } }
    ]
  },
  {
    question: "Quand vous √™tes ensemble, son attention est-elle vraiment sur toi ?",
    answers: [
      { text: "Oui", score: { love: 2 } },
      { text: "√áa d√©pend du contexte", score: { friend: 1 } },
      { text: "Pas vraiment", score: { nothing: 2 } }
    ]
  },
  {
    question: "Est-ce qu'{{subj}} te taquine ou plaisante avec toi ?",
    answers: [
      { text: "Oui, souvent", score: { love: 2 } },
      { text: "Un peu", score: { friend: 1 } },
      { text: "Non", score: { nothing: 2 } }
    ]
  },
  {
    question: "Est-ce qu'{{subj}} te parle de sa vie personnelle ou de ses √©motions ?",
    answers: [
      { text: "Oui, facilement", score: { love: 2 } },
      { text: "Un peu", score: { friend: 1 } },
      { text: "Tr√®s peu", score: { nothing: 2 } }
    ]
  },
  {
    question: "Comment r√©agit-{{subj}} quand tu lui proposes de vous voir ?",
    answers: [
      { text: "{{subjm}} accepte avec enthousiasme", score: { love: 2 } },
      { text: "{{subjm}} accepte parfois", score: { friend: 1 } },
      { text: "{{subjm}} √©vite ou d√©cline", score: { nothing: 2 } }
    ]
  },
  {
    question: "Est-ce qu'{{subj}} te contacte m√™me quand {{subj}} n‚Äôa rien de particulier √† dire ?",
    answers: [
      { text: "Oui", score: { love: 2 } },
      { text: "Rarement", score: { friend: 1 } },
      { text: "Jamais", score: { nothing: 2 } }
    ]
  },
  {
    question: "Quand tu prends de la distance, comment r√©agit-{{subj}} ?",
    answers: [
      { text: "{{subjm}} revient vers moi", score: { love: 2 } },
      { text: "{{subjm}} ne change pas", score: { friend: 1 } },
      { text: "{{subjm}} s‚Äô√©loigne", score: { nothing: 2 } }
    ]
  },
  {
    question: "As-tu d√©j√† senti une forme de jalousie de sa part ?",
    answers: [
      { text: "Oui", score: { love: 2 } },
      { text: "Peut-√™tre", score: { friend: 1 } },
      { text: "Non", score: { nothing: 2 } }
    ]
  },
  {
    question: "Est-ce qu'{{subj}} fait des efforts visibles pour te plaire ?",
    answers: [
      { text: "Oui", score: { love: 2 } },
      { text: "Un peu", score: { friend: 1 } },
      { text: "Pas du tout", score: { nothing: 2 } }
    ]
  },
  {
    question: "Est-ce qu'{{subj}} te fait sentir sp√©cial(e) ou diff√©rent des autres ?",
    answers: [
      { text: "Oui", score: { love: 2 } },
      { text: "Parfois", score: { friend: 1 } },
      { text: "Non", score: { nothing: 2 } }
    ]
  }
];

let index = 0;
let scores = { love: 0, friend: 0, nothing: 0 };

const questionEl = document.getElementById("question");
const answersEl = document.getElementById("answers");
const progressEl = document.getElementById("progress");

function setGender(choice) {
  gender = choice;
  document.getElementById("genderSelect").style.display = "none";
  document.getElementById("quiz").style.display = "block";
  showQuestion(); // c‚Äôest CE QUI d√©clenche l‚Äôaffichage des questions et des r√©ponses
}

function goBack() {
  if (index === 0) return;

  // revenir √† la question pr√©c√©dente
  index--;

  // retirer les points de l‚Äôancienne r√©ponse
  const lastScore = history[index];
  if (lastScore) {
    scores.love -= lastScore.love || 0;
    scores.friend -= lastScore.friend || 0;
    scores.nothing -= lastScore.nothing || 0;
  }

  showQuestion();
}


function g(elle, il, iel) {
  if (gender === "elle") return "elle";
  if (gender === "il") return il;
  return iel;
}

function subj() {
  if (gender === "elle") return "elle";
  if (gender === "il") return "il";
  return "iel";
}

function subjm() {
  if (gender === "elle") return "Elle";
  if (gender === "il") return "Il";
  return "Iel"
}

function poss() {
  if (gender === "elle") return "sa";
  if (gender === "il") return "son";
  return "ses";
}

function handleAnswer(score) {
  // sauvegarde la r√©ponse
  history[index] = score;

  scores.love += score.love || 0;
  scores.friend += score.friend || 0;
  scores.nothing += score.nothing || 0;

  index++;

  if (index < questions.length) {
    showQuestion();
  } else {
    showResult();
  }
}



function showQuestion() {
  const q = questions[index];

  questionEl.classList.remove("fade");
  void questionEl.offsetWidth;
  questionEl.classList.add("fade");

  let text = q.question
    .replaceAll("{{subj}}", subj())
    .replaceAll("{{subjm}}", subjm())
    .replaceAll("{{poss}}", poss());


  questionEl.textContent = text;

  progressEl.textContent = `Question ${index + 1} / ${questions.length}`;
  answersEl.innerHTML = ""; // vide les anciennes r√©ponses

  const progressPercent = ((index) / questions.length) * 100;
  progressFill.style.width = progressPercent + "%";

  q.answers.forEach(a => {
  const btn = document.createElement("button");
  btn.textContent = a.text
    .replaceAll("{{subj}}", subj())
    .replaceAll("{{subjm}}", subjm())
    .replaceAll("{{poss}}", poss());

  btn.onclick = () => handleAnswer(a.score);
  btn.classList.add("fade");
  answersEl.appendChild(btn);
  });

  const backArrow = document.getElementById("backArrow");

  if (index > 0) {
    backArrow.style.display = "block";
  } else {
    backArrow.style.display = "none";
  }

  backArrow.onclick = goBack;

}


function showResult() {

  let result = "";
  let className = "";
  let interpretation = "";
  let actions = "";
  let avoid = "";

  const { love, friend, nothing } = scores;
  const total = love + friend + nothing;

  let percent = Math.round((love / total) * 100);

  // on √©vite les valeurs absurdes
  if (percent > 90) percent = 90;
  if (percent < 5) percent = 5;


  if (love >= total * 0.5 && love > friend) {
    result = "üí• Attirance r√©ciproque claire";
    className = "result-love";
    interpretation = "Les signaux sont coh√©rents et r√©p√©t√©s. L‚Äôint√©r√™t n‚Äôest pas seulement amical.";
    actions = "Propose un moment √† deux dans un cadre simple. Reste naturel et direct.";
    avoid = "Ne suranalyse pas et n‚Äôattends pas trop longtemps.";

  } else if (love > friend && love > nothing) {
    result = "üå± Attirance naissante";
    className = "result-love";
    interpretation = "Il existe une curiosit√© et une attirance, mais elle n‚Äôest pas encore affirm√©e.";
    actions = "Cr√©e des moments complices et augmente l√©g√®rement la proximit√©.";
    avoid = "√âviter la pression ou les d√©clarations trop rapides.";

  } else if (friend >= love && friend >= nothing) {
    result = "ü§ù Zone ambigu√´";
    className = "result-friend";
    interpretation = "Tu es appr√©ci√©(e), mais l‚Äôintention romantique n‚Äôest pas claire.";
    actions = "Change l√©g√®rement ton attitude et introduis plus de spontan√©it√©.";
    avoid = "Ne te comporte pas uniquement comme un confident.";

  } else if (nothing < friend && friend > love) {
    result = "üß± Relation bloqu√©e (zone ami)";
    className = "result-friend";
    interpretation = "La relation est install√©e dans un cadre s√©curisant mais sans tension.";
    actions = "Prends un peu de distance et recentre-toi sur toi.";
    avoid = "Ne sois pas constamment disponible.";

  } else {
    result = "üö™ Peu d‚Äôint√©r√™t r√©el";
    className = "result-nothing";
    interpretation = "Les signes d‚Äôattirance sont faibles ou absents pour le moment.";
    actions = "Respecte la situation et investis ton √©nergie ailleurs.";
    avoid = "Ne force pas les √©changes.";
  }

    questionEl.innerHTML = `<span class="${className}">${result}</span>`;
  answersEl.innerHTML = `
    <p class="advice">${interpretation}<br><strong>Actions :</strong> ${actions}<br><strong>√Ä √©viter :</strong> ${avoid}</p>
    <button onclick="restartQuiz()">üîÑ Refaire le quiz</button>
    <button onclick="shareResult()">üì§ Partager</button>
  `;
  navButtonsEl.innerHTML = ""; // supprime le bouton retour
  progressEl.textContent = "";
  progressFill.style.width = "100%";


  const shareText = `J‚Äôai fait le CrushQuiz üò≥
R√©sultat : ${result}

üëâ Fais le test toi aussi :
${window.location.href}`;


}

function restartQuiz() {
  index = 0;
  history = [];
  scores = { love: 0, friend: 0, nothing: 0 };

  document.getElementById("quiz").style.display = "none";
  document.getElementById("startScreen").style.display = "block";

  progressFill.style.width = "0%";

}


</script>

</body>
</html>
